<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© Ø¯Ø§Ù†ÛŒØ§Ù„!</title>
        <meta name="description" content="Happy Birthday Danial - Paris Saint-Germain Memory Game">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <!-- Persian Font - Vazirmatn -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

        <style>
            /* Base Styles */
            html {
                height: 100%;
            }

            body {
                font-family: 'Vazirmatn', 'Tahoma', 'Arial', sans-serif;
                direction: rtl;
                text-align: right;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                text-rendering: optimizeLegibility;
                background: #000;
                margin: 0;
                min-height: 100%;
                overflow-x: hidden;
            }
            
            /* Confetti Canvas */
            #confetti-canvas {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 99999;
                pointer-events: none;
                transition: opacity 1s ease-out;
            }

            /* Music Toggle Button */
            #music-toggle {
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 10001;
                background-color: #ffc107;
                border: none;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                font-size: 24px;
                cursor: pointer;
                box-shadow: 0 4px 10px rgba(0,0,0,0.3);
                transition: transform 0.2s ease;
            }
            #music-toggle:hover {
                transform: scale(1.1);
            }

            /* Birthday Section Styles */
            #birthday-section {
              background: linear-gradient(135deg, #001F5C 0%, #0066CC 50%, #001F5C 100%);
              padding: 40px 10px;
              text-align: center;
              position: relative;
              display: flex;
              align-items: center;
              justify-content: center;
              direction: ltr; /* Keep birthday section LTR for design */
            }

            .birthday-container {
              position: relative;
              z-index: 10;
              max-width: 600px;
              width: 100%;
              margin: 0 auto;
            }

            .birthday-header {
              margin-bottom: 30px;
            }

            .birthday-title {
              font-size: 2.8rem;
              color: #ffffff;
              margin: 0 0 10px 0;
              text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
              font-weight: 800;
              animation: celebration 2s ease-in-out infinite alternate;
            }

            .birthday-name {
              font-size: 3.5rem;
              color: #D70021;
              margin: 0 0 20px 0;
              text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
              font-weight: 900;
              letter-spacing: 2px;
              animation: glow 2s ease-in-out infinite alternate;
            }
            
            .photo-frame {
              display: inline-block;
              margin: 30px 0;
              position: relative;
            }

            .frame-border {
              background: linear-gradient(45deg, #D70021, #ffffff, #001F5C);
              padding: 8px;
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.4);
            }

            .photo-container {
              width: 320px;
              height: 220px;
              background: linear-gradient(45deg, #f0f8ff, #e6f3ff);
              border-radius: 8px;
              padding: 15px;
              position: relative;
              display: flex;
              justify-content: space-around;
              align-items: center;
            }

            .photo-slot {
              width: 130px;
              height: 180px;
              position: relative;
              border-radius: 8px;
              overflow: hidden;
              border: 2px solid #001F5C;
              cursor: pointer;
              transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .photo-slot:hover {
              transform: scale(1.05);
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }

            .photo-overlay {
              position: absolute;
              top: 0; left: 0; right: 0; bottom: 0;
              background: rgba(0, 31, 92, 0.8);
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              opacity: 0;
              transition: opacity 0.3s ease;
              color: white;
            }
            
            .photo-slot:hover .photo-overlay {
              opacity: 1;
            }

            .zoom-icon {
              font-size: 2rem;
            }

            .photo-overlay::after {
              content: 'Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯';
              font-size: 0.8rem;
              margin-top: 5px;
              direction: rtl;
            }
            
            .photo-slot img {
              width: 100%;
              height: 100%;
              object-fit: cover;
            }
            
            .birthday-message {
              background: rgba(255,255,255,0.95);
              border-radius: 20px;
              padding: 25px;
              margin: 30px 0;
              box-shadow: 0 6px 12px rgba(0,0,0,0.2);
              color: #001F5C;
              font-size: 1.2rem;
              font-weight: 500;
              direction: rtl;
            }

            /* Photo Modal Styles */
            .photo-modal {
              display: none;
              position: fixed;
              z-index: 9999;
              left: 0; top: 0;
              width: 100%; height: 100%;
              background-color: rgba(0, 0, 0, 0.9);
              backdrop-filter: blur(5px);
            }

            .photo-modal-content {
              position: relative;
              margin: 5% auto;
              padding: 20px;
              border-radius: 15px;
              max-width: 90%;
              max-height: 90%;
              text-align: center;
            }
            
            .photo-modal-body img {
              max-width: 100%;
              max-height: 80vh;
              border-radius: 10px;
            }

            .photo-modal-close {
              position: absolute;
              top: 15px;
              right: 35px;
              color: #f1f1f1;
              font-size: 40px;
              font-weight: bold;
              transition: 0.3s;
              cursor: pointer;
            }
            
            /* Animations */
            @keyframes celebration {
              0% { transform: scale(1) rotate(-1deg); }
              100% { transform: scale(1.05) rotate(1deg); }
            }

            @keyframes glow {
              0% { text-shadow: 3px 3px 6px rgba(0,0,0,0.7); }
              100% { text-shadow: 3px 3px 6px rgba(0,0,0,0.7), 0 0 15px rgba(215,0,33,0.5); }
            }

            /* Memory Game Styles */
            #memory-game-section {
                background-color: #0d2e5b;
                padding: 40px 15px;
                font-family: 'Vazirmatn', sans-serif;
                color: white;
                text-align: center;
            }

            .game-container {
                max-width: 700px;
                margin: auto;
                background-color: rgba(0, 31, 92, 0.8);
                border-radius: 20px;
                padding: 25px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 0 15px rgba(255,255,255,0.1);
                border: 2px solid #0066CC;
            }

            .game-header { margin-bottom: 25px; }

            .game-title {
                font-size: 2rem;
                color: #ffd700;
                text-shadow: 2px 2px 5px rgba(0,0,0,0.6);
            }

            .game-stats {
                display: flex;
                justify-content: space-around;
                background: rgba(0,0,0,0.25);
                padding: 12px;
                border-radius: 12px;
                margin-top: 20px;
            }

            .stat-box { font-size: 1.2rem; font-weight: 500; }
            .stat-label { margin-left: 8px; color: #ddd; }
            .stat-value { color: #fff; font-weight: 700; }

            .game-board {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 15px;
                perspective: 1000px;
                margin-bottom: 25px;
            }

            .memory-card {
                background-color: transparent;
                height: 120px;
                border-radius: 10px;
                cursor: pointer;
                position: relative;
                transform-style: preserve-3d;
                transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            }
            
            .memory-card .card-face {
                position: absolute;
                width: 100%; height: 100%;
                -webkit-backface-visibility: hidden;
                backface-visibility: hidden;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 10px;
                box-shadow: 0 4px 10px rgba(0,0,0,0.4);
            }

            .card-face.card-front {
                background: #fff;
                transform: rotateY(180deg);
                padding: 5px;
                box-sizing: border-box;
            }
            
            .card-face.card-front img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                border-radius: 6px;
            }

            .card-face.card-back {
                background: linear-gradient(135deg, #001f5c, #0066CC);
                border: 3px solid #d70021;
            }

            .card-face.card-back img {
                width: 70%;
                height: auto;
            }

            .memory-card.flipped { transform: rotateY(180deg); }
            .memory-card.matched .card-front {
                border: 4px solid #ffd700;
                box-shadow: 0 0 15px #ffd700;
            }
            .memory-card.celebrate { animation: cardCelebration 0.6s ease; }
            @keyframes cardCelebration {
              0%, 100% { transform: rotateY(180deg) scale(1); }
              50% { transform: rotateY(180deg) scale(1.15); }
            }

            .game-btn {
                padding: 12px 30px;
                font-size: 1.1rem;
                border: none;
                border-radius: 50px;
                cursor: pointer;
                transition: all 0.3s ease;
                font-weight: bold;
                font-family: 'Vazirmatn', sans-serif;
                box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            }
            .game-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 6px 12px rgba(0,0,0,0.4);
            }
            #startBtn { background: linear-gradient(45deg, #28a745, #218838); color: white; }
            #resetBtn { background: linear-gradient(45deg, #ffc107, #e0a800); color: #212529; }
            .game-instructions { font-size: 0.9rem; color: #ccc; }

            /* Success Modal Styles */
            .success-modal {
              display: none;
              position: fixed; z-index: 10000;
              left: 0; top: 0; width: 100%; height: 100%;
              background-color: rgba(0, 0, 0, 0.75);
              backdrop-filter: blur(5px);
              justify-content: center; align-items: center;
            }
            .success-modal.show { display: flex; }
            .success-content {
              background: linear-gradient(135deg, #001F5C, #0066CC);
              padding: 30px; border-radius: 20px;
              text-align: center; color: white;
              width: 90%; max-width: 450px;
              box-shadow: 0 10px 30px rgba(0,0,0,0.5);
              animation: modal-pop 0.5s ease-out;
            }
            .success-header h3 { font-size: 2.5rem; margin: 0 0 15px 0; color: #ffd700; }
            .final-stats {
              margin: 20px 0; font-size: 1.2rem; line-height: 1.8;
              background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px;
            }
            .final-stats p { margin: 5px 0; }
            .success-footer { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
            @keyframes modal-pop { from { transform: scale(0.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }

            /* Responsive */
            @media only screen and (max-width: 600px) {
                .birthday-title { font-size: 1.8rem; }
                .birthday-name { font-size: 2.2rem; }
                .photo-container { width: 280px; height: auto; flex-direction: column; align-items: center; justify-content: center; gap: 15px;}
                .photo-slot { width: 115px; height: 140px; }
                .game-board { gap: 10px; }
                .memory-card { height: 90px; }
                .game-title { font-size: 1.5rem; }
                .stat-box { font-size: 1rem; }
            }
        </style>
    </head>
    <body>
        <canvas id="confetti-canvas"></canvas>
        <audio id="bg-music" loop src="https://irsv.upmusics.com/Downloads/Musics/HappyBirthdays%20Bozorgsal%20(15).mp3?_=32"></audio>
        <button id="music-toggle">ğŸµ</button>

        <div id="birthday-section">
             <div class="birthday-container">
                <div class="birthday-header">
                    <h1 class="birthday-title">ğŸ‰ ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© ğŸ‰</h1>
                    <h2 class="birthday-name">Ø¯Ø§Ù†ÛŒØ§Ù„</h2>
                </div>
                
                <div class="photo-frame">
                    <div class="frame-border">
                        <div class="photo-container">
                            <!-- Ø¹Ú©Ø³ Ø§ÙˆÙ„: Ø¢Ø¯Ø±Ø³ Ø¹Ú©Ø³ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ø¯Ùˆ Ù‚Ø³Ù…Øª Ø²ÛŒØ± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†ÛŒØ¯ -->
                            <div class="photo-slot" onclick="openPhotoModal('danial-photo1.png')">
                                <img src="danial-photo1.png" alt="Ø¹Ú©Ø³ Ø¯Ø§Ù†ÛŒØ§Ù„ Û±">
                                <div class="photo-overlay">
                                    <div class="zoom-icon">ğŸ”</div>
                                </div>
                            </div>
                            <!-- Ø¹Ú©Ø³ Ø¯ÙˆÙ…: Ø¢Ø¯Ø±Ø³ Ø¹Ú©Ø³ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ø¯Ùˆ Ù‚Ø³Ù…Øª Ø²ÛŒØ± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†ÛŒØ¯ -->
                            <div class="photo-slot" onclick="openPhotoModal('danial-photo2.png ')">
                                <img src="danial-photo2.png" alt="Ø¹Ú©Ø³ Ø¯Ø§Ù†ÛŒØ§Ù„ Û²">
                                <div class="photo-overlay">
                                    <div class="zoom-icon">ğŸ”</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="birthday-message">
                    <p>Ø§Ù…ÛŒØ¯ÙˆØ§Ø±ÛŒÙ… Ø±ÙˆØ² ØªÙˆÙ„Ø¯Øª Ù¾Ø± Ø§Ø² Ø´Ø§Ø¯ÛŒØŒ Ú¯Ù„ Ùˆ Ù¾ÛŒØ±ÙˆØ²ÛŒ Ø¨Ø§Ø´Ù‡!</p>
                </div>
            </div>
        </div>

        <div id="photoModal" class="photo-modal">
            <span class="photo-modal-close" onclick="closePhotoModal()">&times;</span>
            <div class="photo-modal-content">
                 <div class="photo-modal-body">
                    <img id="photoModalImage" src="" alt="Ø¹Ú©Ø³ Ø¯Ø± Ø§Ù†Ø¯Ø§Ø²Ù‡ Ú©Ø§Ù…Ù„">
                </div>
            </div>
        </div>

        <div id="memory-game-section">
            <div class="game-container">
                <div class="game-header">
                    <h2 class="game-title">ğŸ§  Ø¨Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡ PSG ğŸ†</h2>
                    <div class="game-stats">
                        <div class="stat-box">
                            <span class="stat-label">Ø§Ù…ØªÛŒØ§Ø²:</span> <span id="score" class="stat-value">0</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">Ø­Ø±Ú©Øª:</span> <span id="moves" class="stat-value">0</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">Ø²Ù…Ø§Ù†:</span> <span id="timer" class="stat-value">0:00</span>
                        </div>
                    </div>
                </div>
                <div class="game-board" id="gameBoard"></div>
                <div class="game-controls">
                    <button id="startBtn" class="game-btn">ğŸ® Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
                    <button id="resetBtn" class="game-btn" style="display: none;">ğŸ”„ Ø¨Ø§Ø²ÛŒ Ø¬Ø¯ÛŒØ¯</button>
                </div>
                <div class="game-instructions">
                    <p>ğŸ¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ Ùˆ Ø¬ÙØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø´Ø§Ø¨Ù‡ Ø±Ø§ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯!</p>
                </div>
            </div>
        </div>

        <div id="successModal" class="success-modal">
            <div class="success-content">
                <div class="success-header"><h3>ğŸ‰ ØªØ¨Ø±ÛŒÚ©! ğŸ†</h3></div>
                <div class="success-body">
                    <p>Ø´Ù…Ø§ Ø¨Ø§Ø²ÛŒ Ø±Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªÙ…Ø§Ù… Ú©Ø±Ø¯ÛŒØ¯!</p>
                    <div class="final-stats">
                        <p>Ø§Ù…ØªÛŒØ§Ø² Ù†Ù‡Ø§ÛŒÛŒ: <span id="finalScore">0</span></p>
                        <p>ØªØ¹Ø¯Ø§Ø¯ Ø­Ø±Ú©Øª: <span id="finalMoves">0</span></p>
                        <p>Ø²Ù…Ø§Ù†: <span id="finalTime">0:00</span></p>
                    </div>
                </div>
                <div class="success-footer">
                    <button class="game-btn" onclick="playAgain()">ğŸ® Ø¨Ø§Ø²ÛŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡</button>
                    <button class="game-btn" onclick="closeSuccessModal()">âœ… ØªÙ…Ø§Ù…</button>
                </div>
            </div>
        </div>

        <script>
            // Combined Script for All Features
            (function() {
                'use strict';

                // --- CONFETTI LOGIC ---
                const confettiCanvas = document.getElementById('confetti-canvas');
                const ctx = confettiCanvas.getContext('2d');
                let confettiParticles = [];
                const confettiCount = 80; // Reduced confetti count
                let confettiAnimationId = null;
                const colors = ['#f94144', '#f3722c', '#f8961e', '#f9c74f', '#90be6d', '#43aa8b', '#577590'];

                function resizeCanvas() {
                    confettiCanvas.width = window.innerWidth;
                    confettiCanvas.height = window.innerHeight;
                }

                class ConfettiParticle {
                    constructor() {
                        this.x = Math.random() * confettiCanvas.width;
                        this.y = Math.random() * confettiCanvas.height - confettiCanvas.height;
                        this.size = Math.random() * 10 + 5;
                        this.speed = Math.random() * 5 + 2;
                        this.color = colors[Math.floor(Math.random() * colors.length)];
                        this.angle = Math.random() * 2 * Math.PI;
                        this.spin = Math.random() < 0.5 ? -1 : 1;
                    }
                    update() {
                        this.y += this.speed;
                        this.x += Math.sin(this.angle) * 2;
                        this.angle += 0.05 * this.spin;
                        if (this.y > confettiCanvas.height) {
                            this.y = -20;
                            this.x = Math.random() * confettiCanvas.width;
                        }
                    }
                    draw() {
                        ctx.save();
                        ctx.fillStyle = this.color;
                        ctx.translate(this.x, this.y);
                        ctx.rotate(this.angle);
                        ctx.fillRect(-this.size / 2, -this.size / 2, this.size, this.size);
                        ctx.restore();
                    }
                }

                function createConfetti() {
                    for (let i = 0; i < confettiCount; i++) {
                        confettiParticles.push(new ConfettiParticle());
                    }
                }

                function animateConfetti() {
                    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
                    confettiParticles.forEach(p => {
                        p.update();
                        p.draw();
                    });
                    confettiAnimationId = requestAnimationFrame(animateConfetti);
                }


                // --- MUSIC LOGIC ---
                const music = document.getElementById('bg-music');
                const musicToggle = document.getElementById('music-toggle');
                let isMusicPlaying = false;

                function toggleMusic() {
                     if (isMusicPlaying) {
                        music.pause();
                        musicToggle.textContent = 'ğŸ”‡';
                    } else {
                        music.play().catch(() => { /* Autoplay was blocked */ });
                        musicToggle.textContent = 'ğŸµ';
                    }
                    isMusicPlaying = !isMusicPlaying;
                }
                
                function initialPlay() {
                    isMusicPlaying = true;
                    music.play().catch(() => {
                        isMusicPlaying = false; // if it fails, update state
                    });
                    musicToggle.textContent = 'ğŸµ';
                    document.body.removeEventListener('click', initialPlay);
                    document.body.removeEventListener('touchstart', initialPlay);
                }


                // --- PHOTO MODAL LOGIC ---
                const photoModal = document.getElementById('photoModal');
                const modalImage = document.getElementById('photoModalImage');
                
                window.openPhotoModal = function(imageSrc) {
                    if (photoModal && modalImage) {
                        modalImage.src = imageSrc;
                        photoModal.style.display = 'block';
                    }
                };

                window.closePhotoModal = function() {
                    if (photoModal) {
                        photoModal.style.display = 'none';
                    }
                };
                
                photoModal.addEventListener('click', function(event) {
                    if (event.target === photoModal) closePhotoModal();
                });

                // --- MEMORY GAME LOGIC ---
                const gameBoard = document.getElementById('gameBoard');
                const scoreElement = document.getElementById('score');
                const movesElement = document.getElementById('moves');
                const timerElement = document.getElementById('timer');
                const startBtn = document.getElementById('startBtn');
                const resetBtn = document.getElementById('resetBtn');
                const successModal = document.getElementById('successModal');

                let score = 0, moves = 0, seconds = 0;
                let timerInterval = null, gameStarted = false, canFlip = true;
                let flippedCards = [], matchedPairs = 0;

                // --- Ø¢Ø¯Ø±Ø³ Ø¹Ú©Ø³ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯ ---
                const cardImages = [
                    '1.jpg', '1.jpg',
                '2.jpg', '2.jpg',
            '3.jpg', '3.jpg',
        '4.jpg', '4.jpg',
    '5.jpg', '5.jpg',
'6.jpg', '6.jpg',];

                const psgLogoUrl = 'https://upload.wikimedia.org/wikipedia/en/a/a7/Paris_Saint-Germain_F.C..svg';


                function createBoard() {
                    gameBoard.innerHTML = '';
                    const shuffledCards = [...cardImages].sort(() => Math.random() - 0.5);
                    shuffledCards.forEach(imageUrl => {
                        const card = document.createElement('div');
                        card.className = 'memory-card';
                        card.dataset.imageUrl = imageUrl;
                        card.innerHTML = `
                            <div class="card-face card-front">
                                <img src="${imageUrl}" alt="Ø¨Ø§Ø²ÛŒÚ©Ù† Ù¾Ø§Ø±ÛŒ Ø³Ù† Ú˜Ø±Ù…Ù†" draggable="false">
                            </div>
                            <div class="card-face card-back">
                                <img src="${psgLogoUrl}" alt="Ù„ÙˆÚ¯Ùˆ PSG" draggable="false">
                            </div>`;
                        gameBoard.appendChild(card);
                        card.addEventListener('click', () => flipCard(card));
                    });
                }

                function flipCard(card) {
                    if (!gameStarted || !canFlip || card.classList.contains('flipped') || flippedCards.includes(card)) return;
                    if (moves === 0 && !timerInterval) startTimer();
                    
                    card.classList.add('flipped');
                    flippedCards.push(card);
                    
                    if (flippedCards.length === 1) {
                        moves++;
                        movesElement.textContent = moves;
                    }
                    if (flippedCards.length === 2) {
                        canFlip = false;
                        setTimeout(checkMatch, 1000);
                    }
                }

                function checkMatch() {
                    const [card1, card2] = flippedCards;
                    if (card1.dataset.imageUrl === card2.dataset.imageUrl) {
                        card1.classList.add('matched', 'celebrate');
                        card2.classList.add('matched', 'celebrate');
                        setTimeout(() => {
                           card1.classList.remove('celebrate');
                           card2.classList.remove('celebrate');
                        }, 600);
                        score += 10;
                        scoreElement.textContent = score;
                        matchedPairs++;
                        if (matchedPairs === cardImages.length / 2) setTimeout(gameComplete, 500);
                    } else {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                    }
                    flippedCards = [];
                    canFlip = true;
                }

                function startTimer() {
                    timerInterval = setInterval(() => {
                        seconds++;
                        const minutes = Math.floor(seconds / 60);
                        const remainingSeconds = seconds % 60;
                        timerElement.textContent = `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
                    }, 1000);
                }

                function stopTimer() {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }

                function resetGame(startGameAfter = false) {
                    stopTimer();
                    score = 0; moves = 0; seconds = 0; matchedPairs = 0;
                    flippedCards = []; canFlip = true;
                    gameStarted = startGameAfter;
                    scoreElement.textContent = '0';
                    movesElement.textContent = '0';
                    timerElement.textContent = '0:00';
                    successModal.classList.remove('show');
                    createBoard();
                    startBtn.style.display = startGameAfter ? 'none' : 'inline-block';
                    resetBtn.style.display = startGameAfter ? 'inline-block' : 'none';
                }

                function gameComplete() {
                    stopTimer();
                    gameStarted = false;
                    document.getElementById('finalScore').textContent = score;
                    document.getElementById('finalMoves').textContent = moves;
                    document.getElementById('finalTime').textContent = timerElement.textContent;
                    successModal.classList.add('show');
                }

                window.playAgain = () => resetGame(true);
                window.closeSuccessModal = () => successModal.classList.remove('show');

                function attachEventListeners() {
                    musicToggle.addEventListener('click', toggleMusic);
                    
                    startBtn.addEventListener('click', () => {
                        resetGame(true);
                        // Stop confetti when game starts
                        if (confettiAnimationId) {
                            cancelAnimationFrame(confettiAnimationId);
                            confettiAnimationId = null;
                            confettiCanvas.style.opacity = 0;
                            setTimeout(() => { confettiCanvas.style.display = 'none'; }, 1000);
                        }
                    });

                    resetBtn.addEventListener('click', () => resetGame(true));
                    
                    document.addEventListener('keydown', (e) => {
                        if (e.key === 'Escape') {
                            if (successModal.classList.contains('show')) closeSuccessModal();
                            if (photoModal.style.display === 'block') closePhotoModal();
                        }
                    });
                    
                    window.addEventListener('resize', resizeCanvas);
                    document.body.addEventListener('click', initialPlay, { once: true });
                    document.body.addEventListener('touchstart', initialPlay, { once: true });
                }
                
                // Initialize Everything
                document.addEventListener('DOMContentLoaded', () => {
                    // Game
                    createBoard();
                    
                    // Confetti
                    resizeCanvas();
                    createConfetti();
                    animateConfetti();
                    
                    // Event Listeners
                    attachEventListeners();
                });
            })();
        </script>
    </body>
    <footer style="text-align: center; padding: 15px; background: #001F5C; color: white; font-size: 0.9rem;">
        <p>Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ â¤ï¸ Ø§Ø² Ø·Ø±Ù Ø®Ø§Ù„Ù‡ Ø²Ú©ÛŒÙ‡ Ùˆ Ø¹Ù…Ùˆ Ù‡Ø§Ø¯ÛŒ</p>
    </footer>     
</html>

